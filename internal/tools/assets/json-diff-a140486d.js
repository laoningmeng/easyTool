import{v as i,k as n,F as y,m as S,d as D,av as L,z as g,ac as I,ax as P,e as m,n as l,j as J,q as Y,w as V,ad as b,y as z,o as v,B as x,E as M,p as O,C as G}from"./index-a828413e.js";import{J as h}from"./index-d4e515d0.js";import{u as H}from"./copy-1dd92e81.js";import{_ as K}from"./FormItem-a888e5b4.js";import{_ as Q}from"./Switch-72472d29.js";import{w as C}from"./defaults-4d6daddf.js";import{i as W}from"./boolean-c7e7c785.js";import"./use-form-item-cff217fe.js";function X(e,t,{onlyShowDifferences:s=!1}={}){return i.isArray(e)&&i.isArray(t)?{key:"",type:"array",children:q(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:p(e,t)}:i.isObject(e)&&i.isObject(t)?{key:"",type:"object",children:E(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:p(e,t)}:{key:"",type:"value",oldValue:e,value:t,status:p(e,t)}}function E(e,t,{onlyShowDifferences:s=!1}={}){return Object.keys({...e,...t}).map(o=>R(e==null?void 0:e[o],t==null?void 0:t[o],o,{onlyShowDifferences:s})).filter(o=>!s||o.status!=="unchanged")}function R(e,t,s,{onlyShowDifferences:a=!1}={}){const o=_(e);return o==="object"?{key:s,type:o,children:E(e,t,{onlyShowDifferences:a}),oldValue:e,value:t,status:p(e,t)}:o==="array"?{key:s,type:o,children:q(e,t,{onlyShowDifferences:a}),value:t,oldValue:e,status:p(e,t)}:{key:s,type:o,value:t,oldValue:e,status:p(e,t)}}function q(e,t,{onlyShowDifferences:s=!1}={}){const a=Math.max(0,e==null?void 0:e.length,t==null?void 0:t.length);return Array.from({length:a},(o,r)=>R(e==null?void 0:e[r],t==null?void 0:t[r],r,{onlyShowDifferences:s})).filter(o=>!s||o.status!=="unchanged")}function _(e){return e===null?"value":Array.isArray(e)?"array":typeof e=="object"?"object":"value"}function p(e,t){if(e===void 0)return"added";if(t===void 0)return"removed";const s=_(e)==="object"&&_(t)==="object",a=_(e)==="array"&&_(t)==="array";return i.isEqual(e,t)?"unchanged":s||a?"children-updated":"updated"}function Z({diff:e}){return n("div",{class:"diffs-viewer"},[n("ul",null,[B({diff:e,showKeys:!1})])])}function B({diff:e,showKeys:t=!0}){const{type:s,status:a}=e;return a==="updated"?w({diff:e,showKeys:t}):s==="array"?T({diff:e,showKeys:t,showChildrenKeys:!1,openTag:"[",closeTag:"]"}):s==="object"?T({diff:e,showKeys:t,openTag:"{",closeTag:"}"}):j({diff:e,showKeys:t})}function j({diff:e,showKeys:t}){const{value:s,key:a,status:o,oldValue:r}=e,u=o==="removed"?r:s;return n("li",null,[n("span",{class:[o,"result"]},[t&&n(y,null,[n("span",{class:"key"},[a]),": "]),k({value:u,status:o})]),S(",")])}function w({diff:e,showKeys:t}){const{value:s,key:a,oldValue:o}=e;return n("li",{class:"updated-line"},[t&&n(y,null,[n("span",{class:"key"},[a]),": "]),k({value:o,status:"removed"}),k({value:s,status:"added"}),S(",")])}function T({diff:e,openTag:t,closeTag:s,showKeys:a,showChildrenKeys:o=!0}){const{children:r,key:u,status:c,type:f}=e;return n("li",null,[n("div",{class:[f,c],style:{display:"inline-block"}},[a&&n(y,null,[n("span",{class:"key"},[u]),": "]),t,r.length>0&&n("ul",null,[r.map(d=>B({diff:d,showKeys:o}))]),`${s},`])])}function ee(e){return i.isNull(e)?"null":JSON.stringify(e)}function k({value:e,status:t}){const s=ee(e),{copy:a}=H({source:s});return n("span",{class:["value",t],onClick:()=>a()},[s])}const te={key:0},se={flex:"","justify-center":""},oe={key:0,"text-center":"","op-70":""},ae=D({__name:"diff-viewer",props:{leftJson:{},rightJson:{}},setup(e){const t=e;L(d=>({"7a613f80":l(r).text.mutedColor,ed7825ee:l(r).success.colorFaded,"31e3079f":l(r).success.color,"8956bfb8":l(r).error.colorFaded,"3a20e0b8":l(r).error.color,"29d2da8a":l(r).text.baseColor}));const s=g(!1),{leftJson:a,rightJson:o}=I(t),r=P(),u=m(()=>X(a.value,o.value,{onlyShowDifferences:s.value})),c=m(()=>i.isEqual(a.value,o.value)),f=m(()=>!i.isUndefined(a.value)&&!i.isUndefined(o.value));return(d,N)=>{const U=Q,A=K,F=z;return l(f)?(v(),J("div",te,[Y("div",se,[n(A,{label:"Only show differences","label-placement":"left"},{default:V(()=>[n(U,{value:l(s),"onUpdate:value":N[0]||(N[0]=$=>x(s)?s.value=$:null)},null,8,["value"])]),_:1})]),n(F,{"data-test-id":"diff-result"},{default:V(()=>[l(c)?(v(),J("div",oe," The provided JSONs are the same ")):(v(),M(l(Z),{key:1,diff:l(u)},null,8,["diff"]))]),_:1})])):b("",!0)}}});const ne=O(ae,[["__scopeId","data-v-d84bb557"]]),_e=D({__name:"json-diff",setup(e){const t=g(""),s=g(""),a=m(()=>C(()=>h.parse(t.value),void 0)),o=m(()=>C(()=>h.parse(s.value),void 0)),r=[{validator:u=>u===""||W(()=>h.parse(u)),message:"Invalid JSON format"}];return(u,c)=>{const f=G;return v(),J(y,null,[n(f,{value:l(t),"onUpdate:value":c[0]||(c[0]=d=>x(t)?t.value=d:null),"validation-rules":r,label:"Your first JSON",placeholder:"Paste your first JSON here...",rows:"20",multiline:"","test-id":"leftJson","raw-text":"",monospace:""},null,8,["value"]),n(f,{value:l(s),"onUpdate:value":c[1]||(c[1]=d=>x(s)?s.value=d:null),"validation-rules":r,label:"Your JSON to compare",placeholder:"Paste your JSON to compare here...",rows:"20",multiline:"","test-id":"rightJson","raw-text":"",monospace:""},null,8,["value"]),n(ne,{"left-json":l(a),"right-json":l(o)},null,8,["left-json","right-json"])],64)}}});export{_e as default};
